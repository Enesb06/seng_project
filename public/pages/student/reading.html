<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reading Materials - LearnENG.com</title>
    
    <link rel="stylesheet" href="../../assets/css/main.css">
    <link rel="stylesheet" href="../../assets/css/dashboard.css">
    <link rel="stylesheet" href="../../assets/css/reading.css">
    
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
 
    <!-- Tercih ve Yeni Materyal Olu≈üturma Modalƒ± -->
    <div id="preferences-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <button id="close-modal-btn" class="close-button">&times;</button>
            <h2>Create New Material</h2>
            <p>Let's create a personalized reading material for you.</p>
            <form id="preferences-form">
                <label for="interest-category">What Topic Interests You?</label>
                <!-- ======================= BU Lƒ∞STE G√úNCELLENDƒ∞ ======================= -->
                <select id="interest-category" required>
                    <option value="" disabled selected>-- Select a category --</option>
                    <option value="technology">Technology</option>
                    <option value="science">Science</option>
                    <option value="history">History</option>
                    <option value="art and culture">Art and Culture</option>
                    <option value="travel">Travel</option>
                    <option value="daily life">Daily Life</option>
                    <option value="sports">Sports</option>
                    <option value="nature and environment">Nature and Environment</option>
                    <option value="health and wellness">Health and Wellness</option>
                    <option value="entertainment">Entertainment</option>
                    <option value="food and cooking">Food and Cooking</option>
                </select>
                <!-- ======================= G√úNCELLEME SONU ======================= -->

                <label for="text-type">What Type of Text Do You Want to Read?</label>
                <select id="text-type" required>
                    <option value="" disabled selected>-- First select a category --</option>
                </select>

                <datalist id="all-text-type-options">
                    <option value="article">Article</option>
                    <option value="news report">News Report</option>
                    <option value="short story">Short Story</option>
                    <option value="fairy tale">Fairy Tale</option>
                    <option value="fable">Fable</option>
                    <option value="diary">Diary</option>
                    <option value="dialogue">Dialogue</option>
                    <option value="biography">Biography</option>
                    <option value="blog post">Blog Post</option>
                    <option value="opinion essay">Opinion Essay</option>
                    <option value="problem-solution essay">Problem-Solution Essay</option>
                    <option value="review">Review</option>
                    <option value="email">Email</option>
                </datalist>

                <label for="difficulty-level">What's Your English Level?</label>
                <select id="difficulty-level" required>
                    <option value="A1">A1 (Beginner)</option>
                    <option value="A2">A2 (Elementary)</option>
                    <option value="B1">B1 (Intermediate)</option>
                    <option value="B2">B2 (Upper-Intermediate)</option>
                    <option value="C1">C1 (Advanced)</option>
                </select>
                <label for="content-length">What Should Be the Material Length?</label>
                <select id="content-length" required>
                    <option value="short">Short (~150 words)</option>
                    <option value="medium">Medium (~300 words)</option>
                    <option value="long">Long (~500+ words)</option>
                </select>
                <button type="submit" id="generate-content-btn">Create</button>
            </form>
        </div>
    </div>
 
    <div class="dashboard-container">
        <!-- SOL MEN√ú (SIDEBAR) -->
        <aside class="sidebar">
            <div class="logo"><a href="../../student.html">LearnENG</a></div>
            <nav>
                <ul>
                    <li><a href="../../student.html"> Home</a></li>
                    <li class="active"><a href="reading.html"> Reading Materials</a></li>
                    <li><a href="favorites.html"> Favorites</a></li>
                    <li><a href="wordlist.html"> Word List</a></li>
                    <li><a href="quiz.html"> Quizzes</a></li>
                    <li><a href="ai-chat.html"> AI Assistant</a></li>
                    <li><a href="support.html"> Support</a></li>
                    <li><a href="profile.html"> My Profile & Statistics</a></li>
                    <li><a href="../common/settings.html"> Settings</a></li>
                </ul>
            </nav>
        </aside>
 
        <!-- ANA ƒ∞√áERƒ∞K B√ñL√úM√ú -->
        <div class="main-content" style="height: 100vh; display: flex; flex-direction: column; overflow: hidden;">
            <!-- √úst Ba≈ülƒ±k -->
            <header class="dashboard-header" style="flex-shrink: 0;">
                <h2>Reading Materials</h2>
                <div class="user-info" style="display: flex; align-items: center; gap: 15px;">
                    <img id="header-avatar" src="https://api.dicebear.com/7.x/avataaars/svg?seed=base" style="width: 35px; height: 35px; border-radius: 50%; border: 2px solid #4CAF50; object-fit: cover;">
                    <span id="welcome-message"></span>
                    <button id="logout-button">Logout</button>
                </div>
            </header>
 
            <!-- Ana √áalƒ±≈üma Alanƒ± -->
            <main class="content-area" style="flex: 1; overflow: hidden; padding: 20px;">
                <div class="reading-layout" style="display: grid; grid-template-columns: 300px 1fr; gap: 20px; height: 100%;">
                    
                    <!-- SOL S√úTUN: Liste ve Ge√ßmi≈ü -->
                    <div class="sidebar-column card" style="display: flex; flex-direction: column; height: 100%; overflow: hidden; padding: 0;">
                        <div style="padding: 15px; border-bottom: 1px solid #eee;">
                            <h3 style="margin:0; font-size: 1rem;">My Materials</h3>
                            <button id="new-material-btn" class="cta-button" style="margin-top:10px; padding: 5px; width: 100%;">+ Create New</button>
                        </div>
                        
                        <div id="materials-list" style="flex: 1; overflow-y: auto; padding: 10px;"></div>
                        
                        <div style="padding: 10px 15px; background: #f1f5f9; border-top: 1px solid #ddd; border-bottom: 1px solid #ddd;">
                            <h3 style="margin:0; font-size: 0.9rem;">üìú Note History</h3>
                        </div>
                        <div id="note-history-list" style="flex: 1; overflow-y: auto; padding: 10px;">
                        </div>
                    </div>
 
                    <!-- SAƒû S√úTUN: Metin ve Not Kutusu -->
                    <div class="reader-column card" style="display: flex; flex-direction: column; height: 100%; overflow: hidden; padding: 0;">
                        <div id="reading-container" class="reading-container" style="flex: 1; overflow-y: auto; padding: 30px;">
                            <h1 id="reading-title">Please select an article</h1>
                            <div id="reading-body" style="font-size: 1.1rem; line-height: 1.8;"></div>
                            <div id="loader" class="hidden">AI is writing...</div>
 
                            <button id="favorite-btn" class="favorite-btn" type="button">‚ô°</button>
                        </div>
 
                        <div id="note-editor-area" style="flex-shrink: 0; background: #fafafa; border-top: 3px solid #4CAF50; padding: 20px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                                <h4 style="margin:0;">üìù My Notes for This Article</h4>
                                <span id="save-indicator" style="color: green; font-weight: bold; display: none;">Saved!</span>
                            </div>
                            <textarea id="note-textarea" rows="4" style="width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; resize: none; font-family: inherit;" placeholder="Write your notes for this article..."></textarea>
                            <button id="save-note-btn" class="cta-button" style="width: 100%; margin-top: 10px; background: #4CAF50;">Save Note (Ctrl+Enter)</button>
                        </div>
                    </div>
 
                </div>
            </main>
        </div>
    </div>
 
    <div id="translation-tooltip">
      <strong id="tooltip-word">Word</strong>
      <span id="tooltip-meaning" class="meaning">Loading meaning...</span>
    
      <div class="tooltip-actions" style="display: flex; gap: 8px; margin-top: 8px;">
          <button id="add-to-wordlist-btn" class="add-btn">Add to Word List</button>
          <button id="play-pronunciation-btn" class="speak-btn" title="Listen to Pronunciation">üîä</button>
      </div>
    </div>
 
    <script type="module" src="../../assets/js/student/reader.js"></script>
  
    <script type="module">
      const params = new URLSearchParams(window.location.search);
      const openId = params.get('open');

      if (openId) {
        const tryOpen = () => {
          if (window.displayMaterial) {
            window.displayMaterial(openId);
          } else {
            setTimeout(tryOpen, 50);
          }
        };
        tryOpen();
      }
    </script>
</body>
</html>